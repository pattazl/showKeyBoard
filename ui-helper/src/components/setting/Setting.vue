<template>
  <div>
    <n-space vertical>
      <h2 id="General">{{ contentText?.menu?.setting1 }}</h2>
      <n-card title="é€šç”¨è®¾ç½®">
        <n-list hoverable>
        <n-list-item>è¦å¿½ç•¥è®°å½•çš„æŒ‰é”®  <n-dynamic-tags v-model:value="skipRecordRef" />
        </n-list-item>
        <n-list-item>
          æ˜¯å¦å¿½ç•¥å•ç‹¬çš„æ§åˆ¶é”®
           <div class="intro">æ§åˆ¶é”®ä¸»è¦ä¸º Ctrl,Alt,Shift,Win</div>
           <template #suffix>
            <n-switch :round="false" /> 
          </template>
        </n-list-item>
        <n-list-item>æ˜¯å¦æ˜¾ç¤ºå’Œè®°å½•é¼ æ ‡äº‹ä»¶
          <template #suffix>
            <n-switch :round="false" /> 
          </template>
        </n-list-item>
        <n-list-item>æ˜¯å¦è®°å½•é¼ æ ‡ç§»åŠ¨è·ç¦» 
          <template #suffix>
            <n-switch :round="false" /> 
          </template>
        </n-list-item>
        <n-list-item>æ˜¯å¦æ˜¾ç¤ºæŒ‰é”®  <div class="intro">ä¸´æ—¶æ˜¾ç¤ºå’Œå…³é—­å¿«æ·é”®ä¸ºã€‚ã€‚ã€‚</div>
          <template #suffix>
            <n-switch :round="false" /> 
          </template>
        </n-list-item>
        <n-list-item>æ˜¯å¦è®°å½•æŒ‰é”® 
          <template #suffix>
            <n-switch :round="false" /> 
          </template>
        </n-list-item>
        <n-list-item>æ˜¯å¦æ˜¾ç¤ºæ§åˆ¶é”®çŠ¶æ€
          <div class="intro">æ§åˆ¶é”®ä¸»è¦ä¸º Ctrl,Alt,Shift,Win  å‡ºç°åˆ™æ˜¾ç¤º</div>
          <template #suffix>
            <n-switch :round="false" /> 
          </template>
        </n-list-item>
        <n-list-item>åç«¯æœåŠ¡ç«¯å£å·
          <template #suffix >
            <n-input-number v-model:value="allPara.common.serverPort" :min="80" :max="65535" />
          </template>
        </n-list-item>
        <n-list-item>æŒ‰é”®æ˜¾ç¤ºä»…é’ˆå¯¹æ´»è·ƒçª—å£ 
          <template #suffix>
            <n-input v-model:value="allPara.common.activeWindowProc" type="text" placeholder="ä½¿ç”¨æ­£åˆ™åŒ¹é…çª—å£è¿›ç¨‹å" />
          </template>
        </n-list-item>
      </n-list>
      </n-card>
      <h2  id="KeyUI">{{ contentText?.menu?.setting2 }}</h2>
      <n-card title="æŒ‰é”®å®æ—¶æ˜¾ç¤ºç•Œé¢">
        <n-list hoverable>
          <n-list-item>å®½åº¦
            <template #suffix>
              <n-input-number v-model:value="allPara.dialog.guiWidth" :min="1" :max="65535" />
            </template>
          </n-list-item>
          <n-list-item>é«˜åº¦<div class="intro">ä¸º0è¡¨ç¤ºè‡ªé€‚åº”</div>
            <template #suffix>
              <n-input-number v-model:value="allPara.dialog.guiHeigth" :min="0" :max="65535" />
            </template>
          </n-list-item>
          <n-list-item>èƒŒæ™¯è‰²å’Œé€æ˜åº¦
            <template #suffix>
              <n-color-picker v-model:value="allPara.dialog.guiWidth" :modes="['hex']" />
            </template>
          </n-list-item>
          <n-list-item>é¼ æ ‡ç©¿é€<div class="intro">å¯ä»¥ç‚¹å‡»åˆ°æç¤ºæ¡†ä¸‹æ–¹çš„çª—ä½“</div>
            <template #suffix>
              <n-switch v-model:value="allPara.dialog.guiTrans" :round="false" /> 
            </template>
          </n-list-item>
          <n-list-item>å­—ä½“<div class="intro">é€‰æ‹©ç³»ç»Ÿçš„å­—ä½“</div>
            <template #suffix>
                <n-select v-model:value="allPara.dialog.guiTextFont" :options="allFontRef" />
            </template>
          </n-list-item>
          <n-list-item>å­—ä½“å¤§å°
            <template #suffix>
              <n-input-number v-model:value="allPara.dialog.guiTextSize" :min="1" :max="100" />
            </template>
          </n-list-item>
          <n-list-item>æ˜¯å¦ç²—ä½“
            <template #suffix>
              <n-switch v-model:value="allPara.dialog.guiTextWeight" :round="false" /> 
            </template>
          </n-list-item>
          <n-list-item>å­—ä½“é¢œè‰²
            <template #suffix>
              <n-color-picker v-model:value="allPara.dialog.guiTextColor" :modes="['hex']" />
            </template>
          </n-list-item>
          <n-list-item>æ˜¾ç¤ºå¤šå°‘æ¯«ç§’æ¶ˆå¤±
            <template #suffix>
              <n-input-number v-model:value="allPara.dialog.guiLife" :min="10" :max="100000" />
            </template>
          </n-list-item>
          <n-list-item>çª—ä½“é—´éš”æ¯«ç§’
            <template #suffix>
              <n-input-number v-model:value="allPara.dialog.guiInterval" :min="10" :max="100000" />
            </template>
          </n-list-item>
          <n-list-item>ä¸Šä¸‹å·¦å³ä½ç½®<div class="intro">æç¤ºæ¡†å‡ºç°çš„å±å¹•ä½ç½®</div>
            <template #suffix>
                <n-select v-model:value="allPara.dialog.guiPos"
                :options="[{label:'å·¦ä¸Š',value:'TL'},{label:'å³ä¸Š',value:'TR'},{label:'å·¦ä¸‹',value:'BL'},{label:'å³ä¸‹',value:'BR'}]" />
            </template>
          </n-list-item>
          <n-list-item>çª—å£ç§»åŠ¨ä½ç½®<div class="intro">æ¨ªå‘æˆ–å‚ç›´ç§»åŠ¨</div>
            <template #suffix>
                <n-select v-model:value="allPara.dialog.guiPosXY" :options="[{label:'X'},{label:'Y'}]" />
            </template>
          </n-list-item>
          <n-list-item>ä½ç½®Xè°ƒæ•´<div class="intro">æ¨ªå‘ä½ç½®è°ƒæ•´ï¼Œè´Ÿæ•°è¡¨ç¤ºå¾€å·¦ï¼Œæ­£æ•°è¡¨ç¤ºå¾€å³</div>
            <template #suffix>
                <n-input-number v-model:value="allPara.dialog.guiPosOffsetX" />
            </template>
          </n-list-item>
          <n-list-item>ä½ç½®Yè°ƒæ•´<div class="intro">çºµå‘ä½ç½®è°ƒæ•´ï¼Œè´Ÿæ•°è¡¨ç¤ºå¾€ä¸Šï¼Œæ­£æ•°è¡¨ç¤ºå¾€ä¸‹</div>
            <template #suffix>
                <n-input-number v-model:value="allPara.dialog.guiPosOffsetY" />
            </template>
          </n-list-item>
          <n-list-item>æ˜¯å¦è¿›è¡ŒDPI
            <template #suffix>
                <n-switch v-model:value="allPara.dialog.guiDpiscale" :round="false" />
            </template>
          </n-list-item>
          <n-list-item>ç¬¬å‡ ä¸ªå±å¹•<div class="intro">åˆ†è¾¨ç‡ä¸º {{  }}</div>
            <template #suffix>
              <n-select v-model:value="allPara.dialog.guiMonitorNum"
                :options="screenNum" />
            </template>
          </n-list-item>
          <n-list-item>æç¤ºçª—å£é—´çš„é—´éš”
            <template #suffix>
              <n-input-number v-model:value="allPara.dialog.guiMargin" />
            </template>
          </n-list-item>
          <n-list-item>æ˜¯å¦æœ‰ç»†è¾¹æ¡†
            <template #suffix>
                <n-switch v-model:value="allPara.dialog.guiEdge" :round="false" />
            </template>
          </n-list-item>
          <n-list-item>æŒ‰é”®åˆ†éš”ç¬¦,ç”¨äºæŒ‰é”®é—´çš„æ˜¾ç¤ºåˆ†å‰²
            <template #suffix>
              <n-input v-model:value="allPara.dialog.txtSplit" type="text" placeholder="æ¨èç”¨ç©ºæ ¼" />
            </template>
          </n-list-item>
          <h4>é•¿æŒ‰æ˜¾ç¤º,ä¸»è¦ç”¨äºæ§åˆ¶é”®,å¦‚Ctrlã€Altã€LWinã€Shiftã€RWinã€CapsLockç­‰</h4>
          <n-list-item>æ§åˆ¶é”®Xä½ç½®
            <template #suffix>
              <n-input-number v-model:value="allPara.dialog.ctrlX" />
            </template>
          </n-list-item>
          <n-list-item>æ§åˆ¶é”®Yä½ç½®
            <template #suffix>
              <n-input-number v-model:value="allPara.dialog.ctrlY" />
            </template>
          </n-list-item>
          <n-list-item>æ§åˆ¶é”®å­—ä½“å¤§å°
            <template #suffix>
              <n-input-number v-model:value="allPara.dialog.ctrlTextSize" :min="1" :max="100" />
            </template>
          </n-list-item>
          <n-list-item>æ§åˆ¶é”®æ¸…å•
              <n-dynamic-tags v-model:value="ctrlListRef" />
          </n-list-item>
          <n-list-item>å“ªäº›æŒ‰é”®ä¸ä¼šæ˜¾ç¤ºï¼Œä½†ä¼šè®°å½•
              <n-dynamic-tags v-model:value="skipShowRef" />
          </n-list-item>

        </n-list>
      </n-card>
      <h2 id="StatPara">{{ contentText?.menu?.setting3 }}</h2>
      <n-card title="æ•°æ®ç»Ÿè®¡ç•Œé¢çš„ç›¸å…³å‚æ•°è®¾ç½®">
        <n-list hoverable>
          <n-list-item>å±å¹•å¤§å°(è‹±å¯¸)
            <template #suffix>
              <n-input-number :value="1" :min="1" :max="65535" />
            </template>
          </n-list-item>
        </n-list>
      </n-card>
      <h2 id="KeyMap">{{ contentText?.menu?.setting4 }}</h2>
      <n-card>
        <n-dynamic-input
          v-model:value="keyMappintRef"
          preset="pair"
          key-placeholder="æŒ‰é”®å"
          value-placeholder="æ˜¾ç¤ºçš„æŒ‰é”®ç¬¦å·"
        />
      </n-card>
      <n-card>
        <br />
        <br />
        <br />
        <br />
        <h2>LoadingBar</h2>
        <n-button type="primary" @click="">
          useLoadingBar
        </n-button>
      </n-card>
      <a id="KeyMap">KeyMap</a>
      <br />
      <br />
      <br />
      <br />
      <n-card>

        <h2>LoadingBar</h2>
        <n-button type="primary" @click="">
          useLoadingBar
        </n-button>
      </n-card>
      <a id="Save">Save</a>
      <br />
      <br />
      <br />
      <br />
      <n-card>

        <h2>LoadingBar</h2>
        <n-button type="primary" @click="">
          useLoadingBar
        </n-button>
      </n-card>
    </n-space>
  </div>
</template>

<script lang="ts">
import { defineComponent, onMounted ,PropType,ref,computed } from 'vue'
import { useRoute } from 'vue-router';
import content from '../../content.js';
// import { useAustinStore } from '../../App.vue'

function splitArr(str){
  let arr =[]
  if( str.length > 0){
    arr = str.split('|')
  }
  return arr;
}
// ç”Ÿæˆç•Œé¢ä¸Šselectçš„æ•°ç»„
function toVSelectList(arr:Array<string|number>){
  let resArr = [];
  for(let v of arr)
  {
    resArr.push({ label:v,value:v })
  }
  return resArr
}
// ç”Ÿæˆç•Œé¢ä¸Škey,valueæ•°ç»„
function toKVList(obj:{}){
  let resArr = [];
  for(let k in obj)
  {
    resArr.push({ key:k,value:obj[k] })
  }
  return resArr
}
export default defineComponent({
  name: 'Setting',
  props:{
    lang: {
      type: String as PropType<'en-US' | 'zh-CN'>,
    },
  },
  setup(props) {
    // const store= useAustinStore(); å¯é€šè¿‡ å±æ€§ä¼ é€’ï¼Œä¹Ÿå¯é€šè¿‡piniaä¼ é€’
    // const lang = computed(()=>store.lang) 
    const contentText = computed(()=>content[props.lang]) 
    //watch(() => store.lang, (newValue, oldValue) => {
    //  console.log(` lang New value: ${newValue}, old value: ${oldValue}`);
    //});
    // å„ç±»æ•°æ®æ¨¡æ‹Ÿ
    const allPara = ref({
      "common": {
        "skipRecord": "",
        "skipCtrlKey": "0",
        "needShowKey": "1",
        "needRecordKey": "1",
        "ctrlState": "1",
        "serverPort": "9900",
        "showMouseEvent": "3",
        "recordMouseMove": "1",
        "activeWindowProc": ""
      },
      "dialog": {
        "guiWidth": "240",
        "guiHeigth": "0",
        "guiBgcolor": "11AA99",
        "guiBgTrans": "0",
        "guiTrans": "1",
        "guiOpacity": "150",
        "guiTextFont": "Verdana",
        "guiTextSize": "26",
        "guiTextWeight": "bold",
        "guiTextColor": "FF0000",
        "guiLife": "7000",
        "guiInterval": "1000",
        "guiPos": "BR",
        "guiPosXY": "Y",
        "guiPosOffsetX": "0",
        "guiPosOffsetY": "-50",
        "guiDpiscale": "0",
        "guiMonitorNum": "2",
        "guiMargin": "5",
        "guiEdge": "1",
        "txtSplit": " ",
        "ctrlX": "10",
        "ctrlY": "5",
        "ctrlTextSize": "20",
        "ctrlList": "Ctrl|Alt|LWin|Shift|RWin|CapsLock",
        "skipShow": "<^<+a|PrintScreen"
      }
    })
    // å­—ä½“æ¸…å•
    const allFont = ['å®‹ä½“','é›…é»‘','Verdana'];
    // æŒ‰é”®åŒ¹é…æ¸…å•
    const keyMappint = {
      'Space' : ' â£',
'<^' : ' ^+',
'>^' : ' ^+',
'<!' : ' â‡+',
'>!' : ' â‡+',
'<+' : ' â‡§+',
'>+' : ' â‡§+',
'<#' : ' âŠ+',
'>#' : ' âŠ+',
'Enter' : ' â†©',
'Left' : ' â¬… ',
'Up' : 'â¬†ï¸ ',
'Down' : 'â¬‡ ',
'Right' : 'â',
'LControl' : ' ^',
'RControl' : ' ^',
'LWin' : ' âŠ',
'RWin' : ' âŠ',
'LAlt' : ' â‡',
'RAlt' : ' â‡',
'LShift' : ' â‡§',
'RShift' : ' â‡§',
'Backspace' : ' BS',
'Escape' : ' Esc',
'CapsLock' : 'Caps',
'Delete' : 'Del ',
'Insert' : 'Ins',
'PrintScreen' : 'PrtSc',
'ScrollLock' : 'Scroll',
'Insert' : 'Ins',
'PgUp' : ' PgUp',
'AppsKey' : ' Menu ',
'Ctrl' : ' ^',
'LWin' : ' âŠ',
'RWin' : ' âŠ',
'Alt' : ' â‡',
'Shift' : ' â‡§',
'WheelUp' : ' â‡¡',
'WheelDown' : ' â‡£',
'MButton' : ' ğŸ–²ï¸',
'LButton' : ' ğŸ–±ï¸',
'RButton' : ' ğŸ–°',
    }
    // å±å¹•æ•°æ®
    const screenInfo = [{Left:0, Top:0, Right:100, Bottom:200},{Left:0, Top:0, Right:100, Bottom:200}]
    let a = [...Array(screenInfo.length).keys()]
    const screenNum = toVSelectList( [...Array(screenInfo.length).keys()].map(x => x + 1) )

    // æ•°æ®å¤„ç†
    const allFontRef = toVSelectList(allFont)

    const keyMappintRef = ref(toKVList(keyMappint));
    const skipRecordRef = ref(splitArr(allPara.value.common.skipRecord))
    const ctrlListRef = ref(splitArr(allPara.value.dialog.ctrlList)) 
    const skipShowRef = ref(splitArr(allPara.value.dialog.skipShow))

    const handleShowMessage = () => {
      console.log('I can use message')
    }
    // è‡ªåŠ¨è·¯ç”±è¯†åˆ«å’Œæ»šåŠ¨
    const route = useRoute()
    const scrollToSection = () => {
      const section = route.params.section;
      console.log('Setting:' + section)
      if (section) {
        // æ»šåŠ¨åˆ°å¯¹åº”çš„é”šç‚¹ä½ç½®
        const element = document.getElementById(section.toString());
        if (element) {
          element.scrollIntoView({ behavior: 'smooth' });
        }
      }
    }
    onMounted(() => {
      scrollToSection();
    })
    return {
      handleShowMessage,
      allPara,
      skipRecordRef,
      contentText,
      ctrlListRef,
      skipShowRef,
      allFontRef,
      screenNum,
      keyMappintRef,
    }
  },
})
</script>
<style scoped>
.intro {
  font-size:smaller;
  color:#2080f0;;
}
.n-input-number{
  width:150px
}
.n-color-picker , .n-select {
  width:180px;
}
.n-input{
  width:300px;
}
</style>